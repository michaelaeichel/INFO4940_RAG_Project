Leaving flatland: Diagnostics for Lagrangian coherent structures in three-dimensional flows

Abstract
Finite-time Lyapunov exponents (FTLE) are often used to identify Lagrangian Coherent Structures (LCS).
Most applications are confined to flows on two-dimensional (2D) surfaces where the LCS are characterized as curves.
The extension to three-dimensional (3D) flows, whose LCS are 2D structures embedded in a 3D volume, is theoretically straightforward.
However, in geophysical flows at regional scales, full prognostic computation of the evolving 3D velocity field is not computationally feasible.
The vertical or diabatic velocity, then, is either ignored or estimated as a diagnostic quantity with questionable accuracy.
Even in cases with reliable 3D velocities, it may prove advantageous to minimize the computational burden by calculating trajectories from velocities on carefully chosen surfaces only.
When reliable 3D velocity information is unavailable or one velocity component is explicitly ignored, a reduced FTLE form to approximate 2D LCS surfaces in a 3D volume is necessary.
The accuracy of two reduced FTLE formulations is assessed here using the ABC flow and a 3D quadrupole flow as test models.
One is the standard approach of knitting together FTLE patterns obtained on adjacent surfaces.
The other is a new approximation accounting for the dispersion due to vertical (u,v) shear.
The results are compared with those obtained from the full 3D velocity field.
We introduce two diagnostic quantities to identify situations when a fully 3D computation is required for an accurate determination of the 2D LCS.
For the ABC flow, we found the full 3D calculation to be necessary unless the vertical (u,v) shear is sufficiently small.
However, both methods compare favorably with the 3D calculation for the quadrupole model scaled to typical open ocean conditions.
Highlights
•
Approximations of 2D Lagrangian coherent structures in 3D flows are studied.
•
Vertical shear is shown to be important in the three-dimensional flows.
•
A new approximate Cauchy-Green tensor without using vertical velocities is proposed.
•
Two velocity gradient diagnostics help to decide when the full 3D velocity is needed.

Introduction
Hassan Aref's 1984 seminal paper on chaotic advection [1] initiated a new direction for fluid mechanics research.
Dynamical systems theory (DST) has provided a theoretical and computational basis for much of the subsequent developments.
DST methods are now widely used to identify critical material structures that govern transport patterns.
In geophysical flows, these structures persist from a few hours to weeks.
They are precisely identified by evolving distinguished invariant manifolds.
Jones and Winkler [2] provide a widely used algorithm for computing such manifolds in two-dimensional (2D) flows.
The methodology has been extended to three-dimensional (3D) dynamical systems by Branicki and Wiggins [3].
Although theoretically appealing, invariant manifold calculations are tedious and not easily automated.
Consequently, a much simpler, easily automated approach for determining approximate transport barriers from finite-time Lyapunov exponents (FTLE) has been developed [4-6].
The patterns in FTLE and related diagnostic fields are now known in the literature as Lagrangian Coherent Structures (LCS).
It is well known that LCS delineated by invariant manifolds and those derived from FTLE are equivalent for simple analytically prescribed flows.
However, this appears not to be true generally.
Branicki and Wiggins [7] made an extensive comparison of both methods and established useful criteria for identifying when they are in agreement.
Here, we study FTLE, with the expectation that our conclusions apply to the identification of transport barriers, within the provisos established by Branicki and Wiggins [7].
It is noteworthy that other diagnostics of LCS have been proposed [8-14].
All LCS diagnostics have attributes that are appropriate for particular situations.
Moreover, our impression is that all diagnostics agree when there are clear and robust LCS signatures.
Since all diagnostics are derived from trajectories, the effects of the approximations discussed here are likely to carry over to approaches other than FTLE as well.
Most studies that use DST methods to identify transport barriers have considered Hamiltonian-type flows and been restricted to 2D ([15], and references therein).
This restriction, however, is not a theoretical limitation, since the mathematical constructs have no dimensional requirements [16].
Indeed, several applications of DST methods to idealized 3D flows have been published[17-21,7].
Haller [22] developed a theoretical framework for calculating LCS in 3D flows and applied it to steady and unsteady Arnold-Beltrami-Childress (ABC) flows.
Lekien et al. [23] extended LCS theory to n-dimensional systems.
These and other studies have provided considerable theoretical insight into the topology of stirring and mixing in 2D and 3D flows.
However, they are largely based on analytically prescribed flows or simple numerical models.
Extensions of 2D methods to realistic 3D flows present a number of challenges that are not addressed in these studies.
Some computational fluid dynamics studies require millions of particle trajectories to adequately resolve the complexity of the 2D LCS in 3D flows.
To reduce the prohibitive associated computational cost, alternative algorithms that rely on reduced representations of the Cauchy-Green tensor have been proposed [24].
The approach of using a reduced Cauchy-Green tensor is attractive in the context of 3D geophysical flows, since the computation of 3D trajectories is hampered by a lack of reliable information about diabatic (atmosphere) or vertical (ocean) velocities.
These velocities are typically orders of magnitude smaller than the other two velocity components, and in many cases they are diagnostic variables recovered outside the prognostic model update cycle.
The value of including the effects of approximate diabatic or vertical velocities in LCS computations remains unclear.
As most geophysical flows are nearly 2D, one might anticipate vertical particle excursions to be negligible.
However, small vertical excursions can lead to significant horizontal end point differences due to vertical (u,v) shear [25].
These considerations lead to the basic question addressed here: Under what conditions can 2D velocity fields satisfactorily generate 2D LCS in 3D flows?
Due to the unreliability of the third velocity component in many situations, the answer to this question should ideally be based on a diagnostic readily available from 2D model flows.
Models for geophysical flows frequently solve the momentum equations for horizontal (respectively adiabatic) velocities in horizontal (respectively adiabatic) layers, leaving the normal velocity to be derived from the incompressibility condition.
Thus, information on two of the three velocity components and six of the nine velocity gradient components is provided directly.
This suggests a metric based on the magnitude of the components of the 2D velocity gradient tensor that are normal to the surfaces, since that information is currently not utilized in typical 2D analyses.
The importance of this quantity was also highlighted by Branicki et al. [26], who show that invariant manifolds are nearly vertical within a layer whose thickness is much smaller than the ratio of the horizontal velocities to their vertical gradients.
Also missing from the standard 2D analysis is any information on the normal velocity and its gradients, leading to the consideration of a second diagnostic capturing these effects.
To assess the impacts of these neglected velocity gradient components, 2D LCS derived from FTLE ridges are considered.
The structures obtained from 2D components of prescribed 3D velocity fields are compared with those from the full 3D fields.
For clarity in presentation, the geometry of the prescribed flows is here taken to be Cartesian, and the 2D surfaces are specified as horizontal planes.
Two approaches for approximating 2D LCS from the 2D velocity field are considered.
The first treats each vertical level independently, with the 2D FTLE computed from 2D trajectories on each layer within the volume of interest.
This is the "business as usual" approach adopted by Branicki and Kirwan [27] in their assessment of the lobe structure of a large anticyclonic ring in the Gulf of Mexico.
See also Bettencourt et al. [28] for a variation of this approach.
The second approach again uses 2D trajectories along each level surface, but accounts for the additional 3D dispersion due to horizontal separations between particle pairs in adjacent levels.
See Sulman et al. [29] for examples of this approach.
When computing FTLE in a 3D volume, the additional computational cost of the second approximation is minimal, since both approximations require 2D trajectories computed along each vertical level.
There is an additional approach that might be considered for approximating 2D LCS in cases where the full 3D velocity is known: using 3D trajectories, but restricting the analysis to a plane embedded in the flow.
Along this plane, the 3D FTLE can be approximated with a reduced Cauchy-Green tensor using only trajectories initialized on the plane, effectively neglecting normal gradients.
Garth et al. [24] compared this planar approximation with the full 3D rendering of FTLE fields and reported that the fields agreed quite well.
Since this approach requires vertical velocities that are normally not available in geophysical models, and since the computational savings vis-à-vis the full solution are minimal in this context, we chose not to discuss this approach further.
Two test flows are used in the analysis.
The first is the well-studied ABC flow.
The second, which is more relevant to geophysical flows, is a quadrupole with the velocities scaled to match typical open ocean conditions.
We anticipate that the results presented here will have some relevance to atmospheric flows when the diabatic velocities are small relative to the horizontal velocities.
We also discuss only steady flow.
We found that adding prescribed time periodicity yielded little additional insight for these two test flows.
There are fundamental issues with more general time dependence, the most crucial being interaction between the integration period for evaluating the Cauchy-Green tensor and the intrinsic time scales of the flow.
A thorough investigation of this matter is ongoing.
The report is organized as follows.
Section 2 reviews FTLE theory.
Section 3 provides a useful paradigm for studying arbitrary incompressible flows and describes the two test models.
Section 4 assesses the impact of the two FTLE approximations in a steady ABC flow and analyzes the critical parameters in the problem.
A steady quadrupole model is used to assess situations with more geophysical relevance in Section 5.
A summary of the results and some additional remarks are given in Section 6.
Review of 3D FTLE theory
Consider the flow (1)dxdt=v(x,t),x∈Ω⊂R3,t∈[t0,tf] where v is a smooth velocity field and Ω is an open subset of R3.
Let x(t;t0,x0) denote the trajectory solution of (1) at time t with x(t0;t0,x0)=x0.
This solution is given by (2)x=x0+∫t0tv(x,τ)dτ.
The right Cauchy-Green tensor is defined as (3)G=FTF, where the superscript T signifies the matrix transpose and F is the strain tensor (4)F=∂x∂x0=I+∫t0t∂v∂x⋅∂x∂x0dτ with I the identity matrix.
The FTLE is then given by (5)Λ(tf;t0,x0)=log(λmax(G))tf-t0, where λmax(G) is the maximum eigenvalue of the matrix G.
Repelling LCS are typically defined as ridges of local maxima in the FTLE field computed from trajectories in forward time (tf>t0).
Similarly, attracting LCS are defined as ridges in the backward-time (tf<t0) FTLE field [4,22].
Where the peak values of these ridges are high, they have been shown to be good surrogates for the material manifolds that more precisely delineate LCS [6].
In the full 3D formulation, x=(x,y,z),v=(u,v,w)∈R3, and (6)F0=∂x∂x0=[∂x∂x0∂x∂y0∂x∂z0∂y∂x0∂y∂y0∂y∂z0∂z∂x0∂z∂y0∂z∂z0].
Our first FTLE approximation treats 2D horizontal cross-sections of Ω individually, so that x=(x,y) and v=(u,v).
In this case, tensor G is second order, with (7)F1=∂x∂x0=[∂x∂x0∂x∂y0∂y∂x0∂y∂y0].
While this approximation follows standard practice, it inherently neglects the fact that ocean flows are essentially 3D.
A more appropriate reduction of the full matrix (6) for 2D cross-sections would be (8)F1̃=[∂x∂x0∂x∂y00∂y∂x0∂y∂y00001].
The singular values of F1 (i.e. the eigenvalues of G1) are identical to two of the singular values of F1̃, whose additional singular value is 1.
For incompressible flows, det(G0)=det(F0)=1 so that volumes are conserved under the flow map.
Since G0 is symmetric and positive definite (with three positive eigenvalues), λmax(G0)≥1.
In the following, we will restrict our discussion to such flows.
It is likely then (although not guaranteed) that (7) and (8) will yield equivalent results.
They will differ only where λmax(G1)<1, leading to a negative FTLE.
We did not encounter this problem in any of the cases reported here.
Our second FTLE approximation also ignores the vertical velocity w, which can be problematic in many geophysical fluid dynamics models, but considers vertical gradients, i.e. x∈R3 but ∂z/∂t=0∀x,t.
Consequently, (9)F2=∂x∂x0=[∂x∂x0∂x∂y0∂x∂z0∂y∂x0∂y∂y0∂y∂z0001].
Unlike approximation F1,F2 accounts for the effects of vertical shear in the horizontal velocity components.
To summarize, we will compare three different FTLE formulations: 1.
3D form of tensor G with trajectories from 3D velocities(10)FTLE3d3d=log(λmax(G0))tf-t0with G0=F0TF0
2.
2D form of tensor G with trajectories from 2D velocities(11)FTLE2d2d=log(λmax(G1))tf-t0with G1=F1TF1
3.
3D form of tensor G with trajectories from 2D velocities(12)FTLE3d2d=log(λmax(G2))tf-t0with G2=F2TF2.
It follows from these definitions (see the Appendix) that (13)FTLE3d2d≥FTLE2d2d∀tf,to,x0.
However, there is no similar general relationship between FTLE3d3d and either of the two approximations.
It follows directly from the above that FTLE2d2d=FTLE3d2d if ∂x/∂z0=∂y/∂z0=0.
Due to (4), this condition is satisfied if ∂u/∂z=∂v/∂z=0∀x,t.
Define (14)Sv=(∂u∂z)2+(∂v∂z)2 as the measure of the vertical shear in the horizontal velocities.
When Sv=0∀x,t,FTLE2d2d=FTLE3d2d.
We propose to determine threshold Sv values for which FTLE2d2d and FTLE3d2d differ significantly.
Similarly, (10) and (12) imply that FTLE3d3d=FTLE3d2d if ∂z/∂x0=∂z/∂y0=0 and ∂z/∂z0=1.
Due to (4), this condition is satisfied if ∂w/∂x=∂w/∂y=∂w/∂z=0∀x,t.
To identify cases when FTLE3d2d is a poor approximation for FTLE3d3d, the relevant diagnostic is therefore the magnitude of the vertical velocity gradient: (15)Sw=(∂w∂x)2+(∂w∂y)2+(∂w∂z)2.
Generally, both Sv and Sw are functions of t and x.
However, below only steady flows are analyzed.
Furthermore, whenever there is x-dependence, we will focus on the maximum values achieved.
The notation max(Sv) and max(Sw) will imply maxima taken over space x.
In Sections 4 and 5, FTLE3d3d, defined in (10) and derived from the full 3D formulation, is the benchmark against which the two approximations FTLE2d2d, defined in (11), and FTLE3d2d, defined in (12), are evaluated.
To quantify the roles of Sv and Sw, the root-mean-square (RMS) differences between FTLE3d3d and each of the approximations are computed.
To simplify the notation, we define (16)Δ1=|FTLE3d3d-FTLE2d2d|(17)Δ2=|FTLE3d3d-FTLE3d2d| and use the notation RMS(Δi) for the respective RMS values.
Admittedly, this criterion is somewhat crude, as it does not focus singularly on the ridges that define the LCS but includes off-ridge data.
It does capture differences in ridge sharpness.
Ridge position shifts are considered separately, but an adequate metric to quantify these differences eludes us.
For the computation of the FTLE, trajectories are determined by integrating the differential equation (1) using DLSODA from the Fortran ODEPACK library [30] with an absolute tolerance of 1×10-6 and a relative tolerance of 1×10-6.
The derivatives in the Cauchy-Green tensors are then approximated using second-order centered finite-differences.
Eigenvalues are calculated analytically using algebraic expressions.
Test models for 3D incompressible flows
We study the impact of the vertical velocity and the vertical shear of the horizontal velocity components on the FTLE approximations in two analytic 3D flows.
The first is the well known ABC flow [31], in which the scales of the vertical velocities and the vertical shear of horizontal velocities are commensurate with the corresponding horizontal scales.
Results of the analysis of this model are presented in Section 4.
In many geophysical fluid flows, however, the vertical velocities are small relative to the horizontal velocities, and there may be a disparity between the magnitudes of the horizontal and vertical shears.
Since the ABC model cannot adequately represent these flows, we also study a single mode quadrupole model.
Results and analysis for this model are described in Section 5.
Even though our analyses are purely kinematic, we stress that both of these models have a dynamical basis.
The ABC flow is an exact periodic solution to the nonlinear Euler equations in a non-rotating frame, while the quadrupole model solves the linear Euler equations on an f-plane in a periodic domain.
Both model flows can be expressed in the vector potential representation of a general 3D incompressible flow [32] with the 3D velocity v given in terms of two scalar potentials Ψ and Φ as (18)v=∇×[-Ψk+∇×(Φk)].
Generally, k can be the unit vector normal to any preferred surface.
We take k to be the vertical unit vector, so the velocity components are (19a)u=-∂Ψ∂y+∂2Φ∂z∂x,(19b)v=∂Ψ∂x+∂2Φ∂z∂y,(19c)w=-∇h2Φ, where ∇h2 is the Laplacian with respect to the horizontal coordinates, i.e., (20)∇h2=∂∂x2+∂∂y2.Ψ and Φ are solutions to Helmholtz equations with Dirichlet and Neumann boundary conditions, respectively.
Each can be expressed in terms of sine and cosine functions for our two model domains, both of which are rectangular and periodic.
Steady ABC flow
The steady ABC flow can be derived from (19) by defining Ψ and Φ as (21a)Ψ=-[Csin(y)+Bcos(x)],(21b)Φ=A[-xcos(z)+ysin(z)]-Ψ, where x,y,z∈R.
The velocity components are then (22a)u=Asin(z)+Ccos(y),(22b)v=Bsin(x)+Acos(z),(22c)w=Csin(y)+Bcos(x).Fig. 1 shows example cross-sections of this velocity field with A=1 and B=C=0.8.
We focus only on cases where B2+C2≥A2≥|B2-C2|.
Note that this assures the existence of stagnation points in the flow (see [33] for more details).
We also choose B=C.
With this choice, the two free parameters independently control the two diagnostics.
Sv=A and is constant throughout the domain, while Sw=B2sin2(x)+C2cos2(y)=|B|sin2(x)+cos2(y), with values ranging from 0 to |B|2.
The left inequality of the stagnation point condition above is therefore equivalent to max(Sw)≥Sv.
The computations presented in Section 4 are performed on a grid of size 201×201×201 for x,y,z∈[0,2π], from time t0=0 to tf=10.
Steady quadrupole flow
The steady quadrupole flow is obtained from (19) by defining Ψ and Φ as (23a)Ψ=A(z)sin(πx/Lx)sin(πy/Ly),(23b)Φ=B(z)cos(πx/Lx)cos(πy/Ly), where x∈(-Lx,Lx),y∈(-Ly,Ly), and z∈(-H,0).
In this case, the velocity components are (24a)u=-(αyA(z)+αxBz(z))sin(αxx)cos(αyy),(24b)v=(αxA(z)-αyBz(z))cos(αxx)sin(αyy),(24c)w=(αx2+αy2)B(z)cos(αxx)cos(αyy), where (25)Bz=∂B∂z(26)αx=π/Lx(27)αy=π/Ly.
We will restrict our analysis to a domain with Lx=Ly, so that we can define α=αx=αy.
Sulman et al. [29] used this model to illustrate manifolds and associated flow properties for a prescribed free surface with non-zero velocity.
Here the focus is on investigating the parameter space of Sv and Sw.
For clarity, it is useful to further restrict the analysis to functions for A and B that are at most linear in z, i.e., (28a)A(z)=(1/α)[A0+A1z](28b)B(z)=(1/2α2)[B0+B1z].
Horizontal and vertical length and velocity parameters can be scaled to be appropriate for the atmosphere or ocean.
We choose typical oceanic values, setting the horizontal domain dimensions to Lx=Ly=200km.
The domain depth is allowed to be infinite.
This is a computational convenience necessitated by the linear vertical profiles of w, which lead in extreme cases to a handful of particles in the domain reaching depths below 20 km.
Various boundary conditions could be imposed at a more realistic oceanic depth.
We have examined several and found no impact on our conclusions.
At any depth z in this flow, the LCS (ridges in the FTLE field) are straight lines at x=[-Lx,0,Lx] and y=[-Ly,0,Ly].
Computations are performed on a horizontal grid of size 257×257 from time t0=0 to time tf=8days.
The results presented here focus on a single horizontal layer at z=-0.3km.
RMS differences as well as maxima are computed over this single layer only.
Trajectories in adjacent vertical layers at z=-0.29km and z=-0.31km are also computed to allow for finite-difference approximation of strain tensor terms involving vertical gradients, using a 10 m vertical spacing representative of many ocean models.
Parameter values in Section 5 are reported so that all quadrupole velocities have units of m s-1.
With z in units of kilometers, this implies that A0 and B0 have units of m s-1, and A1 and B1 have units of m s-1 km-1.
Note that B0 is the peak w magnitude at z=0, and when Bz=0,A0 is the peak horizontal velocity magnitude at z=0.
Fig. 2 shows a steady quadrupole flow at depths 100, 500, 1000, and 1500 m with A(z) and B(z) defined as in (28).
Notice that the quadrupole strength varies linearly with depth.
LCS in steady ABC flows
The role of Sv and Sw in determining the accuracy of the two FTLE approximations given in Section 2 is first tested on the ABC flow.
The range of values for the parameters was chosen to sample a reasonably large section of the parameter space, within the constraints of permitting stagnation points within the flow.
B and C are always set to be equal.
This condition implies that there is no scaling difference between the two horizontal velocities.
As discussed in Section 3.1, the two ABC parameters independently control the two diagnostics, with Sv=A and Sw depending only on B, with values ranging from 0 to |B|2.
We proceed by systematically varying one of the parameters while keeping the other fixed, resulting in two series of experiments.
As noted in Section 3.1, the condition guaranteeing stagnation points in the flow also implies that max(Sw)≥Sv.
This is the reverse of the situation studied in the quadrupole flow (Section 5).
Fixed max(Sw) with increasing Sv
We first consider a series of cases with Sv=A=[0.1,0.2,…,1.1], keeping B=C fixed at a value of 0.8 for max(Sw)=1.13.
Two examples of the three FTLE fields and their differences (Δ1=|FTLE3d3d-FTLE2d2d| and Δ2=|FTLE3d3d-FTLE3d2d|) are shown in Figs.
3 and 4 for Sv=0.1 and Sv=1.1, respectively.
Fig. 5(a)-(e) show cross-sections of the same five fields at z=2π for an intermediate Sv value (Sv=0.5).
When Sv is small, both FTLE approximations (FTLE3d2d and FTLE2d2d) adequately capture much of the larger-scale LCS structure (Fig. 3).
As Sv increases, however, both approximate FTLEs miss important smaller scale structure (Fig. 5), and for large Sv (Fig. 4), the differences are particularly striking, as both approximate FTLEs miss important vertical structure (Fig. 4(b)-(c)) when compared with the benchmark (Fig. 4(a)).
Fig. 5 suggests that accuracy of the two FTLE approximations degrades steadily as Sv increases.
Plots of RMS FTLE differences (computed over the entire domain) as a function of Sv (Fig. 5(f)) confirm this steady degradation in both approximations over the range of Sv considered here.
Curiously, both RMS difference curves exhibit inflection points near Sv=0.8.
Although A=B=C when Sv=0.8, a simple explanation for this feature in the difference growth rate eludes us.
Fig. 5(f) shows that FTLE3d2d is a better approximation than FTLE2d2d for all Sv values considered.
Note also that as they degrade, the spatial patterns in the two FTLE approximations remain quite similar to each other (Figs.
4(b)-(c) and 5(b)-(c)).
RMS FTLE differences (Fig. 5(f)) are convenient metrics for demonstrating the relationship between increasing Sv and decreasing accuracy in FTLE approximations.
However, because these scalar metrics represent average differences computed over the entire 3D domain, they cannot easily be used to distinguish cases with differences due mostly to errors in FTLE magnitude (as in Fig. 3) from cases with differences due to significant errors in FTLE ridge positions (as in Fig. 4).
The accuracy of approximate FTLE ridge positions can be explored by examining one-dimensional (1D) cross-sections of FTLE2d2d,FTLE3d2d, and FTLE3d3d.
Fig. 6 provides an example along the x-direction at z=2π,y=π/2 for Sv=0.1, 0.5, and 1.1.
These plots demonstrate that ridges in both FTLE2d2d and FTLE3d2d align well with those for FTLE3d3d when Sv=0.1 (Fig. 6(a)).
For larger Sv values (Fig. 6(b)-(c)), FTLE2d2d and FTLE3d2d ridge positions are shifted significantly along the x-axis.
Additionally, when Sv=1.1, peak FTLE values tend to be underestimated and FTLE3d2d overestimates FTLE values near local minima.
These profile plots indicate that neither FTLE2d2d nor FTLE3d2d is a good approximation for FTLE3d3d when the magnitude of Sv approaches that ofmax(Sw).
Fixed Sv with increasing max(Sw)
We now consider the effects of increasing max(Sw) on approximate FTLEs computed for the ABC flow.
Here, Sv is fixed by specifying A=0.1 and Sw is increased by choosing B=C=[0.5,0.6,…,1.5].
Examples of the three FTLE fields and their differences Δ1 and Δ2 are shown in Figs.
7 and 8 for B=C=0.5 and B=C=1.5, respectively.
Fig. 9(a)-(e) show cross-sections of the same five fields at z=2π for an intermediate value (B=C=1.0).
Plots of RMS FTLE differences (computed over the entire domain) as a function of max(Sw) are shown in Fig. 9(f).
Figs. 7 and 8 show that, even for large max(Sw), both approximations capture the LCS structure adequately.
RMS differences increase as max(Sw) increases (Fig. 9(f)), although the differences remain relatively small over the range of max(Sw) values considered here.
At all max(Sw) values considered, the RMS differences show that FTLE3d2d is a better approximation than FTLE2d2d.
Fig. 10 displays 1D cross-sections of FTLE3d3d, FTLE3d2d, and FTLE2d2d along the x-direction at z=2π and y=π/2 for B=C=0.5,1.0,1.5.
These curves show that both FTLE approximations accurately describe peak FTLE values and ridge positions, with only small position differences along the x-axis.
LCS in a steady quadrupole
Analysis of the ABC flow (Section 4) identified the important role that vertical shear of the horizontal velocity plays in 3D LCS.
That analysis also demonstrated that two potentially appealing FTLE approximations can be significantly degraded when this shear is ignored.
In ABC flows, however, all three velocity components have similar scales since w is constrained by the same parameters that control the (u,v) structure.
Consequently, ABC flows are not representative of most geophysical flows which have a natural disparity-typically three orders of magnitude or more-between the vertical and horizontal velocity scales.
To assess the validity of the two FTLE approximations defined in Section 2 for flows with representative geophysical velocity scalings, we now appeal to the quadrupole model described in Section 3.2.
This model allows for a natural separation between the horizontal and vertical velocity scalings.
Like the ABC flow, it also allows Sv and Sw to be varied independently, so that the relative importance of vertical velocities and vertical (u,v) shear can be examined separately.
Given the choices of the model formulation specified in Section 3.2, the two diagnostics take on the following values: (29)Sv=|A1|sin2(αx)cos2(αy)+cos2(αx)sin2(αy) and (30)Sw2=α2(B0+B1z)2[sin2(αx)cos2(αy)+cos2(αx)sin2(αy)]⋯+B12[cos2(αx)cos2(αy)].
For ocean flows, the Richardson shear criterion provides an approximate upper bound on Sv.
From this criterion, we expect N2/Sv2≥0.25 where N is the stratification (Brunt-Väisälä) frequency.
Flows with Sv values exceeding this limit will likely be unstable.
Here, we consider Nmax=1cycle/h (1.75×10-3s-1) as an upper bound for ocean flows and we examine a range of A0 and A1 values corresponding to maximum Sv values ranging from 0.2Nmax to 2Nmax.
An ocean limit on Sw is harder to establish.
To allow for more direct comparisons between quadrupole experiments with w≠0, we choose to fix the maximum vertical velocity magnitude (|w|max) at the analysis depth z=-0.3km at 10-4ms-1 in all cases.
From Eq.
(24c), note that both ∂w/∂x and ∂w/∂y scale like α|w|max=π|w|max/L, where L=Lx=Ly.
For our choices of |w|max=10-4ms-1 and L=200km, these horizontal w gradients do not exceed 1.57×10-9s-1.
For the incompressible ocean flows considered here, the remaining contributor to Sw,∂w/∂z, is equal to the horizontal divergence.
Estimates of ocean mesoscale horizontal divergence from drifter trajectories indicate that a conservative upper bound on its magnitude is 0.1f, where f is the Coriolis parameter [34-36].
Consequently, we choose a representative mid-latitude f value of 1×10-4s-1 and examine a range of B0 and B1 values corresponding to maximum ∂w/∂z magnitudes between 0.01f and 0.1f.
For these parameter choices, since ∂w/∂z is always at least two orders of magnitude larger than either ∂w/∂x or ∂w/∂y,Sw∼|∂w/∂z|.
In Sections 5.1 through 5.3, we consider three quadrupole cases: 1.
Zero vertical (u,v) shear with nonzero vertical velocity gradients (Sv=0,max(Sw)≠0).
2.
Nonzero vertical (u,v) shear with zero vertical velocity (max(Sv)≠0,w=0,Sw=0).
3.
Nonzero vertical (u,v) shear with nonzero vertical velocity (max(Sv)≠0,w≠0,max(Sw)≠0).
These three cases permit the investigation of the effects of Sv and Sw first separately and then jointly.
Zero vertical (u,v) shear with nonzero w gradient
Here we specify Sv=0 and max(Sw)≠0.
This is achieved by setting A1=0.
A0=0.5ms-1, and max(Sw) is varied by choosing (31)B0=-[2,5,8,11,14,17,20,23,26,29]×10-4 in m s-1 and (32)B1=-[1,2,3,4,5,6,7,8,9,10]×10-4 in m s-1 km-1.
For these parameter choices, the peak w magnitude at z=-0.3km is fixed to 10-4ms-1.
In the analysis layer, max(Sw) values, range from 0.0864 to 0.8640days-1.
Note that, since Sv=0,FTLE3d2d and FTLE2d2d are derived from identical Cauchy-Green tensors.
Thus, for this case only FTLE3d3d and FTLE2d2d are compared.
Fig. 11((a)-(c)) show plots of FTLE3d3d,FTLE2d2d, and their absolute difference at z=-0.3km with B0=-2×10-4ms-1 and B1=-10-3ms-1km-1.
The small absolute differences (Fig. 11(c)) demonstrate that FTLE2d2d is an excellent approximation in this case.
Fig. 11(d) shows a plot of RMS(Δ1) versus max(Sw).
This plot indicates that the RMS difference is insignificant (on the order of 10-6days-1) for max(Sw) values up to about 0.43days-1.
For higher values of max(Sw),RMS(Δ1) increases rapidly by at least five orders of magnitude.
Since the peak values of FTLE2d2d are O(1), these differences are significant.
Nonzero vertical (u,v) shear with no vertical velocity
Next we explore how vertical (u,v) shear impacts the FTLE approximations when Sw=0.
From Eq.
(30), this is obtained by specifying B0=B1=0.
The following values are chosen for A0 and A1 to achieve a range of max(Sv): (33)A0=[0.53,0.59,0.65,0.80,0.95,1.10,1.25,1.40,1.55] in m s-1, and (34)A1=[0.10,0.30,0.50,1.00,1.50,2.00,2.50,3.00,3.50] in m s-1 km-1.
These nine (A0,A1) pairs were chosen so that the (u,v) velocities at z=-0.3km remain constant, with a peak value of 0.5 m s-1.
Over this range of A1 values, max(Sv) increases from 1×10-4 s-1 to 3.5×10-3s-1 (0.2Nmax to 2Nmax).
Since w=0 here, the 3D and 2D trajectories are identical.
Hence for this case, FTLE3d2d=FTLE3d3d, and we need only compare FTLE3d3d with FTLE2d2d.
Fig. 12(a)-(c) show the two FTLE fields and their differences at z=-0.3km, with A0=0.53ms-1 and A1=0.10ms-1km-1.
Note that the magnitude of the peak FTLE differences is comparable to the peak FTLE values.
FTLE differences are small at the eddy centers and along the LCS.
Panel (d) of this figure shows the RMS(Δ1) versus max(Sv) for the plane at z=-0.3km.
The RMS differences rise rapidly with max(Sv) at first but increase more slowly after about 50days-1.
Nonzero vertical (u,v) shear, nonzero w gradient
In Sections 5.1 and 5.2, the effects of Sv and Sw were examined separately.
Here, the general case where both max(Sv) and max(Sw) are nonzero is considered.
Ninety separate cases are examined.
These cases pair each of the ten values of max(Sw) explored in Section 5.1 (range of B0 and B1 values shown in Eqs.
(31) and (32)) with the nine values of max(Sv) explored in Section 5.2 (range of A0 and A1 values shown in Eqs.
(33) and (34)).
Fig. 13(a)-(e) show the three FTLE fields and their differences at z=-0.3km, with A0=0.53ms-1,A1=0.10ms-1km-1,B0=-1.1×10-3ms-1, and B1=-4×10-3ms-1km-1.
A comparison of panels (d) and (e) shows that Δ2 is much smaller than Δ1.
In particular, the magnitude of max(Δ1) is comparable to the peak FTLE values, whereas max(Δ2) is an order of magnitude smaller.
Also noteworthy are the uniformly small FTLE differences at the eddy centers and along the LCS, as in the previous section.
At eddy centers, Sv=0 and Sw=0, so that small differences are expected.
The LCS, on the other hand, pass through both maxima and minima in the Sv and Sw fields.
We hypothesize that here the primary direction of dispersion lies in the horizontal plane, resulting in similar FTLE values for the approximations.
Fig. 13(f) shows RMS(Δ1) and RMS(Δ2) versus max(Sv) for the case with max(Sw)=0.3456days-1.
After an initial rise, RMS(Δ2) quickly levels off at a relatively low value, while RMS(Δ1) continues to grow.
Fig. 14 shows contour plots of RMS(Δ1) and RMS(Δ2) as a function of both max(Sw) and max(Sv).
For RMS(Δ2), the controlling diagnostic is max(Sw): For any nonzero value of max(Sv),RMS(Δ2) increases rapidly as max(Sw) increases.
The exception occurs at very low values of max(Sv).
Note that for max(Sv)=0,RMS(Δ2) is small and noticeably lower than for max(Sv)>0.
Sw is therefore important only in the presence of vertical (u,v) shear.
Even though changes in max(Sw) have a greater impact on RMS(Δ2) than changes in max(Sv), an increase in max(Sv) is associated with larger RMS differences for almost all values of max(Sw).
For large max(Sw) (greater than about 0.6days-1), this general rule no longer strictly holds, leading to the counter-intuitive result that increasing max(Sv) may actually improve the accuracy of the FTLE estimate slightly.
This phenomenon may result from aliasing that arises when the integration time approximates an integer multiple of the eddy orbit period at some critical locations in the flow.
Fig. 14(b) shows that, for RMS(Δ1), the situation is reversed: Especially at low values of max(Sv), increasing max(Sw) has little effect.
The errors are dominated by the vertical (u,v) shear effects.
As max(Sv) rises above about 100days-1,max(Sw) becomes more relevant, until it becomes the controlling factor (max(Sv)≳175days-1 and max(Sw)≳0.5days-1).
It is worth noting that for most of the explored parameter space, RMS(Δ1) is close to an order of magnitude larger than RMS(Δ2).
This suggests that the additional computational cost for FTLE3d2d is often justified by the improvement in the FTLE approximation.
The metric used so far in the quadrupole analysis is an RMS difference between the exact FTLE field and FTLE approximations taken over the analysis layer at z=-0.3km.
As for the ABC flow, identification of LCS positions as ridges and valleys may be less error-prone than the exact FTLE magnitudes over the entire field.
Fig. 15 compares FTLE ridge positions, showing 1D cross-sections of FTLE3d3d,FTLE3d2d, and FTLE2d2d at z=-0.3km along an east-west transect at y=100km.
The plots clearly show that both FTLE approximations capture the ridge locations nearly perfectly.
FTLE3d2d also accurately reproduces the steep FTLE drop within the eddies.
Discussion
In baroclinic geophysical flows one expects that LCS are 2D structures embedded in a 3D flow field.
In many models, only 2D velocities are calculated from the primitive equations, with the third component obtained from a diagnostic computation.
Typically that component is small, and since the diagnostic calculation contains numerical uncertainty, it may be preferable to estimate the LCS characterizing a 3D flow with more reliable 2D velocities.
The LCS intersect the corresponding surfaces along 1D curves.
Here we investigated the conditions when 2D velocities are sufficient for delineating these curves.
As discussed in Section 1, the answer has consequences: If these conditions are satisfied, the computational cost can be reduced, in the case of FTLE2d2d cutting the number of required trajectories by a factor of three.
Moreover, the investigation here could validate, or negate, a substantial body of research in oceanography where only 2D velocities are readily available and in atmospheric sciences where diabatic velocities are often neglected.
Our approach was to study this issue with two simple models, the ABC flow and a quadrupole model scaled for open ocean conditions.
In Section 2, we proposed two reduced representations of the Cauchy-Green tensor that utilized just 2D velocity information.
One was the standard 2×2 matrix widely used in oceanography.
The other was a reduced form of the 3×3 matrix that included the vertical shears of the horizontal positions but none of the terms involving gradients of vertical positions.
Two diagnostics were also proposed.
One, Sv, involves the components of the 2D velocity gradient normal to the surfaces.
This is readily computed.
The other metric, Sw, involves the gradients of the vertical/diabatic velocity component.
This is not generally available in general circulation models, but was specified in the simple models used here and employed as a guide to the impact these terms might have on the FTLE estimates.
Comparisons of the FTLE obtained from the two approximations were made with that obtained from the complete 3D velocity fields.
For the ABC model, when Sv was small, the analysis indicated that both approximations adequately described both LCS positions and peak FTLE values regardless of Sw (Section 4.2).
For moderate to large Sv values, neither approximation adequately delineated the 2D LCS (Section 4.1).
In these cases, magnitudes of the approximate FTLEs deviated significantly from the exact value and the approximations produced spurious LCS ridges.
Analysis of the FTLE approximations for the quadrupole were more encouraging.
In this case, the vertical and horizontal velocities along with their gradients were constrained to be consistent with open ocean conditions.
Both FTLE approximations yielded magnitudes comparable to the exact values.
More importantly, no spurious LCS ridges or LCS position errors were discovered.
This suggests that, for geophysical models, approximate FTLEs computed using only 2D velocities may be accurate enough to reliably characterize important mixing structures.
Recent studies have used FTLEs to explore how LCS change with depth in the vicinity of ocean mesoscale eddies.
Branicki and Kirwan [27] and Bettencourt et al. [28] used 2D velocities to show that LCS surfaces near eddies are aligned almost vertically, like "curtains", in the water column.
Our analysis of approximate FTLEs in the idealized quadrupole does not invalidate these studies.
However, a thorough assessment of approximate FTLEs in realistic ocean models is needed.
Such an investigation should be guided by the diagnostics developed here.
In particular, the diagnostic Sv was found useful for determining the accuracy of approximate FTLEs.
Its utility is related to the Richardson criterion noted in Section 5.
This criterion is similar to that identified by Branicki et al. [26], but replaces a scale velocity with N2 and gives a non-dimensional numerical threshold applicable to geophysical flows.
It is used somewhat differently here, in that it characterizes the accuracy of the FTLE approximations and not the verticality of the invariant manifolds.
Our results suggest that large values of Sv identify regions where FTLE2d2d approximations become problematic.
Finally, we recommend the new approximation FTLE3d2d for geophysical flows with no reliable information about vertical or diabatic velocities.
FTLE3d2d accounts for additional dispersion due to vertical (u,v) shear using an approximate Cauchy-Green tensor based on the strain tensor shown in Eq.
(9).
For the quadrupole studied here, this additional dispersion was often significant.
Fig. 15 shows the substantial improvement FTLE3d2d provides when compared with the FTLE2d2d approximation most often used in prior work.
Importantly, the necessary vertical (u,v) shear information is readily available in existing geophysical models.
Acknowledgments
Support for this research came from the Office of Naval Research through grants N00014-10-1-0522 and N00014-11-10081 to the University of Delaware, the Office of Naval Research MURI OCEAN 3D + 1 grant N00014-11-1-0087, a grant from BP/The Gulf of Mexico Research Initiative, and the Mary A.S.
Lighthipe endowment to the University of Delaware.
Below a derivation of the inequality in (13) is given.
Proposition 1
(35)FTLE3d2d≥FTLE2d2d∀tf,to,x0.
Proof
Recall the definitions (36)FTLE2d2d=log(λmax(G1))tf-t0with G1=F1TF1 and (37)FTLE3d2d=log(λmax(G2))tf-t0with G2=F2TF2, where (38)F1=[∂x∂x0∂x∂y0∂y∂x0∂y∂y0] and (39)F2=[].
Note that λmax(Gi)=σmax(Fi), where σmax is the largest singular value.
Define S to be the subspace of R3 spanned by {[1,0,0]T,[0,1,0]T}.
There is an obvious bijection from R2 to S, namely γ([x,y]T)=[x,y,0]T.
Note that γ preserves the L2-norm.
Furthermore, for any vector r∈R2,γ(F1r)=F2(γ(r)).
It is well established (e.g. [37]) that ‖M‖2=σmax(M), where ‖M‖2 denotes the matrix 2-norm, which is defined for an m by n matrix M as (40)‖M‖2=supr∈Rn,‖r‖2=1‖Mr‖2.
In particular, (41)σmax(F1)=supr∈R2,‖r‖2=1‖F1r‖2, and (42)σmax(F2)=supν∈R3,‖ν‖2=1‖F2ν‖2(43)≥supν∈S,‖ν‖2=1‖F2ν‖2(44)=supr∈R2,‖r‖2=1‖F2γ(r)‖2(45)=supr∈R2,‖r‖2=1‖γ(F1(r))‖2(46)=supr∈R2,‖r‖2=1‖F1(r)‖2(47)=σmax(F1).
Consequently, σmax(F2)≥σmax(F1), which implies that FTLE3d2d≥FTLE2d2d.□

